@model ClaimSystem.Models.Claim
@using ClaimSystem.Models

@*
    this view was developed with the assisntace from AI tools
*@

@{
    ViewData["Title"] = "Submit Monthly Claim";
}
<div class="card p-4 mb-4">
    <div class="d-flex align-items-center gap-2 mb-1">
        <span class="icon-pill"><i class="bi bi-file-earmark-plus"></i></span>
        <h1 class="h3 brand-serif mb-0">Lecturer — Submit Monthly Claim</h1>
    </div>
    <p class="lead mb-3">Enter your details, see the total, and send.</p>

    <div class="small stepper mb-3">
        <div class="step active"><span class="dot">1</span> Details</div>
        <div class="step"><span class="dot">2</span> Review</div>
        <div class="step"><span class="dot">3</span> Send</div>
    </div>

    <form id="claimForm" novalidate>
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">Lecturer Name</label>
                <input class="form-control" asp-for="LecturerName" placeholder="e.g., A. Dlamini" />
            </div>
            <div class="col-md-6">
                <label class="form-label">Month</label>
                <input class="form-control" asp-for="Month" placeholder="e.g., September 2025" />
            </div>

            <div class="col-md-4">
                <label class="form-label">Hours Worked</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-hourglass-split"></i></span>
                    <input class="form-control" asp-for="HoursWorked" type="number" step="0.5" min="0" value="0" />
                </div>
                <div class="form-text">Half-hours allowed.</div>
            </div>

            <div class="col-md-4">
                <label class="form-label">Hourly Rate (R)</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-currency-exchange"></i></span>
                    <input class="form-control" asp-for="HourlyRate" type="number" step="1" min="0" value="0" />
                </div>
            </div>

            <div class="col-md-4">
                <label class="form-label">Calculated Amount</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-calculator"></i></span>
                    <input id="calcDisplay" class="form-control" value="R 0.00" disabled />
                </div>
                <div class="form-text">Updated automatically as you type.</div>
            </div>

            <div class="col-12">
                <label class="form-label">Notes (optional)</label>
                <textarea class="form-control" asp-for="Notes" rows="2" placeholder="Add a short note if needed"></textarea>
            </div>

            <div class="col-12">
                <label class="form-label">Upload Supporting Document</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-paperclip"></i></span>
                    <input class="form-control" type="file" aria-label="Upload file">
                </div>
                <div class="form-text">Accepted: .pdf, .docx, .xlsx.</div>
            </div>
        </div>

        <div class="mt-4 d-flex gap-2">
            <button type="button" id="submitBtn" class="btn btn-olive">
                <i class="bi bi-send me-1"></i> Submit
            </button>
            <a class="btn btn-ghost" asp-action="Status">
                <i class="bi bi-activity me-1"></i> Track Status
            </a>
        </div>
    </form>
</div>


<div class="modal fade" id="submittedModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title brand-serif"><i class="bi bi-check2-circle me-2 text-olive"></i>Claim submitted</h5>
                <button class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                ✨ Your claim was prepared successfully. You can track its status any time.
            </div>
            <div class="modal-footer">
                <a class="btn btn-mint" asp-action="Status"><i class="bi bi-arrow-right-circle me-1"></i> Go to Status</a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        
        const fmt = new Intl.NumberFormat('en-ZA', { style:'currency', currency:'ZAR' });
        const hours = document.getElementById('HoursWorked');
        const rate  = document.getElementById('HourlyRate');
        const out   = document.getElementById('calcDisplay');
        function recalc(){ const h=+hours.value||0, r=+rate.value||0; out.value = fmt.format(h*r); }
        [hours,rate].forEach(el=>el?.addEventListener('input', recalc)); recalc();

        const modal = new bootstrap.Modal(document.getElementById('submittedModal'));
        document.getElementById('submitBtn').addEventListener('click', ()=> modal.show());
    </script>
}
